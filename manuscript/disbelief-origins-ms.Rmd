---
output:
  pdf_document: default
 # html_document:
  #  df_print: paged
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(rethinking)
library(tidyverse)
library(ggridges)
library(xtable)
library(ggpubr)
library(kableExtra)
library(knitr)
library(formattable)

# get data ----
go <- read.csv('go.csv')

go$atheist <- go$god_y*-1 + 1
go$disbelief <- go$sbs_m * -1
go$ment_lo <- go$pt_m * -1
go$cred_lo <- go$cred_m * -1
go$security <- go$mot_m * -1
go$reflection <- go$crtZ
go$ageZ <- scale(go$age, center=T, scale=T)[,]
go$educZ <- scale(go$educ, center=T, scale=T)[,]
go$femZ <- scale(go$female, scale=T, center = T)[,]
go$econ_consZ <- scale(go$econ_cons, center=T, scale=T)[,]
go$social_consZ <- scale(go$social_cons, center=T, scale=T)[,]
summary(go)

d <- select(go, 
            disbelief, 
            ment_lo, 
            security, 
            cred_lo, 
            reflection,
            ageZ, educZ, femZ, econ_consZ, social_consZ, eXtra_m, Consc_m, Neuro_m, Agree_m, Open_m, Hum_m)


full_cv_post <- read.csv('full-posterior.csv')


# zero orders
dment_nc <- select(d, disbelief, ment_lo)
dment_nc <- dment_nc[complete.cases(dment_nc),]

dsec_nc <- select(d, disbelief, security)
dsec_nc <- dsec_nc[complete.cases(dsec_nc),]

dcred_nc <- select(d, disbelief, cred_lo)
dcred_nc <- dcred_nc[complete.cases(dcred_nc),]

dref_nc <- select(d, disbelief, reflection)
dref_nc <- dref_nc[complete.cases(dref_nc),]


# combined zero order posteriors
zeros <- read.csv('zero-order-posteriors.csv')



# interactions
intx <- read.csv('CrtCREDPost.csv')

# handy functions ----


bigger <- function(first, second) {
  pr.big <- mean(ifelse(first > second, 1, 0))
  return(pr.big)
}

biggerZero <- function(input) {
  pr.big <- mean(ifelse(input > 0, 1, 0))
  return(pr.big)
}


# a couple of quick functions for pulling HPDIs


low <- function(x){
  v <- HPDI(x, prob=.97)[1]
  return(v)
}


high <- function(x){
  v <- HPDI(x, prob=.97)[2]
  return(v)
}



```

# Dual Inheritance Theory and The Origins Of Religious Disbelief

Will M. Gervais\*^1^,
Nava Caluori^2^,
Sarah R. Schiavone^3^, &
Maxine B. Najle^4^

\scriptsize
^1^Department of Psychology, University of Kentucky 

^2^Department of Psychology, University of Virginia 

^3^Department of Psychology, University of California-Davis

^4^Blue Labs Analytics, Washington, D. C.


\*Corresponding author. Email: will.gervais@gmail.com 

### PREPRINT under review
\normalsize
\pagebreak

## Abstract

**Religion is a core component of human nature, yet a comprehensive scientific account of religion also needs to account for religious disbelief. Despite potentially drastic overreporting of religiosity ##, a third of the world’s 7 billion human inhabitants may actually be atheists—merely people who do not believe in God or gods. The origins of disbelief thus present a key testing ground for theories of religion. Here, we evaluate the predictions of four theoretical approaches to the origins of disbelief, and find considerable support for a dual inheritance (gene-culture coevolutionary) model. Our dual inheritance model ## derives from distinct literatures addressing the putative 1) core social cognitive faculties that enable mental representation of gods ##, 2) motivational antecedents driving people to view some god candidates as strategically important ##, 3) evolved cultural learning processes that influence which god candidates naïve learners treat as real rather than imaginary ##, and 4) the intuitive processes that sustain belief in gods ## and the cognitive reflection that may sometimes undermine it ##. We explore the varied origins of religious disbelief by treating these factors simultaneously in a large nationally representative (USA, *N* = `r nrow(d)`) dataset with preregistered analyses. Combined, we find that receiving few cultural cues of religious commitment is the most potent predictor of religious disbelief, followed distantly by reflective cognitive style. Additional exploration suggests that cognitive reflection may primarily predict reduced religious belief among individuals who witness relatively fewer credible contextual cues of faith in others. This work empirically unites four distinct literatures addressing religious belief and disbelief ##, highlights the utility of considering both evolved cognition and cultural learning in religious transmission ##, emphasizes the dual roles of content-and context-biased social learning, and sheds light on the shared psychological mechanisms that underpin both religious belief and disbelief. **




**Keywords:** atheism; religion; culture; evolution; dual inheritance theory

\pagebreak
# Dual Inheritance Theory and The Origins Of Religious Disbelief

Religion is somewhat an evolutionary puzzle. Organisms like ants and aardvarks tend to eschew painful and costly rituals to prove their faith in unseen ant and aardvark pantheons, respectively. Evolutionary theories of religion have proliferated in recent years ##, and they make starkly different predictions about the nature and origins of religious disbelief: some describe atheism as a cognitive deficit ##, others as a mere self-reporting blip unreflective of underlying cognition ##, and yet others as the natural outcome of certain cultural contexts ##. Thus, the origins of disbelief may prove a crucial testing ground for different theories of religion. Here we test predictions from four theoretical frameworks (secularization, cognitive byproduct, cultural evolution, and an emerging dual inheritance (gene-culture coevolutionary) model of religion ## that views both evolved cognition ## and specific cultural learning mechanisms ## as key to the transmission of either faith or atheism ##. This work situates the study of religious disbelief firmly within established theoretical frameworks for studying the evolution of human behavior and contributes to broader discussions of the role of transmitted (versus evoked) culture in core aspects of human nature ##.

Religion simultaneously unites and divides like few other aspects of social life. The sectarian conflicts between groups of religious believers may obscure a more fundamental schism: that between believers and atheists. Atheists—merely people who do not believe in the existence of a God or gods—constitute a large and perhaps growing proportion of earth’s human population ##. A prominent estimate from the opening decade of the current millennium ## posits the existence of 500-700 million atheists. This estimate is in all likelihood a drastic underestimate ##. Atheism prevalence estimates rely on census and polling data that infer individual beliefs from their self-reports. However, there is potent anti-atheist stigma that transcends national and religious boundaries ##: even atheists harbor some intuitive moral distrust of atheists worldwide ##. Thus, while it is safe to assume that self-reported atheists do not believe in God, it is probably also safe to assume that a great many people privately disbelieve without openly admitting their atheism. Consistent with this, people routinely overreport their religious practices ##, and indirect measurement of atheism in the USA reveals a potentially large gulf between some indirect (~26%) and direct (~3%) estimates of atheist prevalence ##. Combining direct estimates and inferences drawn from the few available indirect estimates, we predict that upwards of 2 billion people on earth may in fact be atheists. Many evolutionary theories of religion posit a universal implicit theism ##, and may thus be fundamentally incompatible with global atheism that is simultaneously prevalent and deliberately concealed. Therefore, sustained research into the origins of disbelief is necessary to test key assumptions of various evolutionary and cultural theories of religion.

While it is clear that a (perhaps unrecognized) large proportion of the global population does not believe in gods, what cognitive, motivational, and cultural factors predict religious disbelief? Distinct research trajectories have considered the preconditions for sustained belief in any given god. To currently believe in a god, one 1) must be able to mentally represent gods, 2) must be motivated to ‘interact’ with gods, 3) must receive credible cultural cues that some gods are real, and 4) must intuitively maintain this belief over time. Tweaks to any of these four components may instead yield disbelief in gods. Separate lines of research partially support this supposition. First, individual differences in mentalizing abilities (one key component of mind perception) predict religious disbelief ## in at least some samples ##. Second, although religion flourishes where life is unstable, existential security predicts reduced religiosity ##. Third, lack of credibility enhancing displays (CREDs) ## that one ought to believe in any gods is a good global predictor of atheism ##. Finally, people who reflectively override their intuitions tend to be less religious than those who ‘go with their guts’ ##, although the magnitude and consistency of this relation is debatable ##. Although these four factors relate to religious disbelief in isolation, little work considers their operation in conjunction ##. 

Different theoretical approaches make divergent predictions about which of these four factors are the most potent predictors of religious disbelief. First, secularization models ## posit that increases in existential security (wealth, health, education) reduce religious motivation; this approach is common in sociology of religion ## and in social psychology, under the banner of compensatory control ##. Second, evolutionary psychology and cognitive science of religion often view religion as a cognitive byproduct of other mental adaptations ##, such as mind perception or predator detection ##. In this view, challenges in the core cognitive faculties underlying such adaptations (e.g., mentalizing) would predict disbelief, as would people being able to override their religious intuitions via cognitive reflection ##. Third, cultural evolutionary models highlight the social learning processes underpinning religious belief and disbelief, and largely predict that context-biased social learning such as CREDs would be strongly associated with degrees of religious belief. Finally, dual inheritance models somewhat integrate these various perspectives, and predict that CREDs would be most important, followed by other factors such as cognitive reflection, mentalizing, and existential security. Table 1 depicts predictions derived from each of these perspectives. By simultaneously considering mentalizing, existential security, CREDs, and cognitive reflection, we are able to evaluate the suitability of each of these four theoretical approaches for understanding the psychological origins of religious disbelief.

We preregistered a set of analyses that pit secularization, cognitive byproduct, socialization, and dual inheritance models against each other. Specifically, we posed three broad questions:

I.	What are the relative contributions of each factor when considered simultaneously?
II.	How do the factors interact with each other in predicting belief and disbelief?
III.	Does early work on each individual factor successfully replicate in a nationally representative sample?

To approach these questions, we contracted a nationally representative sample of USA adults (*N*= `r nrow(d)`) from GfK. Primarily, we were interested in predicting degrees of religious belief and disbelief with measures of 1) advanced mentalizing, 2) existential security, 3) theoretically modeled cues of cultural exposure to credible cues of religiosity (CREDs), and 4) intuitive versus reflective cognitive style. For robustness, we also included a number of demographic and psychological covariates.

Our most important analyses considered the relative contributions of all four factors operating in concert. As preregistered, we report two analyses in which the four core factors predict individual differences in belief and disbelief, both in the presence and absence of additional covariates. In our full model (see Table 2 and Figure 1), few credible displays of faith proved to be by far the most powerful predictor of religious disbelief. Credibility enhancing displays of faith predict belief, and their absence predicts atheism. Cognitive reflection remained a consistent predictor of religious disbelief, but following earlier cross-cultural work ## its predictive power was quite meager. Mentalizing challenges were only weakly associated, if at all, with disbelief, and existential security predicted essentially nothing.

Next, we probed for interactions between the four factors. Results suggest an interaction between cultural learning and reflective cognitive style . We broke down this interaction in two different ways. First, we considered the association between disbelief and reflective cognitive style among those comparatively high and low on credible cultural cues of religious belief (Figure 2a). Reflective cognitive style primarily predicts religious disbelief among those who were also comparatively low in cultural exposure to credible religious cues of faith. Second, we predicted current religious belief from cultural exposure to credibility enhancing displays of religion and then correlated reflective cognitive style with the residual. Effectively, this analysis suggests that reflective thinkers tend to be less religious than one would assume based solely on their cultural exposure to religious cues (Figure 2b). It is thus possible that reflective cognitive style is one mechanism that leads people to lose faith over time ##; in contrast, an intuitive cognitive style leads people to adhere to their early cultural inputs and perhaps become more religious in some contexts. These patterns highlight the interactive roles of cultural context and evolved intuitions on religious cognition, as predicted by dual inheritance theories.

Finally, we tested each candidate factor in isolation, merely to replicate previous work. In individual replication analyses (Table 3), only cultural learning and reflective cognitive style emerged as consistent predictors of religious disbelief. That two of the candidate factors culled from existing literature did not appear as robust predictors in these models may suggest tempered enthusiasm for their utility as predictors of individual differences in religiosity more broadly, although they both (especially existential security) may still be useful in analyzing larger-scale regional and international trends.

Overall, these results present one of the most comprehensive available analyses of the cognitive, cultural, and motivational factors that predict individual differences in religious belief and disbelief in the USA. They also speak directly to competing theoretical models of religious disbelief, culled from sociology, social psychology, evolutionary psychology, cognitive science of religion, cultural evolution, and dual inheritance. Consistent inferences emerged, suggesting that the most potent predictor of disbelief is—by a wide margin—lack of exposure to credibility enhancing displays of religious faith. Once this context-biased cultural learning mechanism is accounted for, one cognitive factor—a reflective cognitive style—predicts some people being slightly more prone to religious disbelief than their cultural upbringing might otherwise suggest. That said, this relationship was relatively miniscule. Mentalizing and motivational features did not meaningfully predict belief and disbelief in this nationally representative sample. Comparing Table 1 and Figure 1, it is clear that our results are most consistent with dual process theories, and any model that does not rely heavily on context-biased cultural learning is likely a poor fit for explaining the origins of religious disbelief. By extension, such models fail as as evolutionary accounts of religion.

It is initially puzzling that existential security proved impotent in our analyses, as it appears to be an important factor in explaining cross-cultural differences in religiosity. Further, it has proven successful in experimental work ##, although these experimental insights may be less robust than initially assumed ##. It is possible that our analyses were at the wrong level of analysis to capture the influence of existential security, which may act as a precursor to other cultural forces. There may actually be a two-stage generational process whereby existential security drives down religious behavior in one generation, leading the subsequent generation to atheism as they do not witness credibility enhancing displays of faith. 

This work suggests two broader meta-scientific points. Of the four candidate factors we tested, one (credibility enhancing displays) is derived from formal theoretical modeling in gene-culture coevolution, while the other three emerged from verbal argumentation. In terms of predicting large-scale real-world patterns, the formally modeled theory empirically outclassed the three ‘veories’ . Verbal theorizing is an important step in the research process, but formal theorizing is an indispensable tool as well ##. Formal models are obviously wrong yet, they are useful mental prostheses simply because they are precisely and transparently wrong ##. Second, most psychology research nowadays emerges from convenience samples of undergraduates and Mechanical Turk workers. These samples are fine for some purposes, but representative samples are necessary for others. While our nationally representative sampling allows us to generalize beyond samples we can access for free (in lab) or cheap (MTurk), even a large nationally representative sample barely scratches the surface of human diversity ##. As such, we encourage similar analyses across different cultures ##. This is especially necessary because cultural cues themselves emerged as the strongest predictor of belief and disbelief. If this general pattern holds across societies, we predict that—beyond religion—veories developed by WEIRD researchers to explain the weird mental states of WEIRD participants will continue to ever more precisely answer only an outlier of an outlier of our most important scientific questions about human nature. 

The importance of transmitted culture and context-biased cultural learning as a predictor of belief and disbelief cannot be overstated. Combined, the data we collected suggest that if you are guessing whether or not individuals are believers or atheists, you are better off knowing how their parents behaved—did they tithe? Pray regularly? Attend synagogue?—than how they themselves process information. Further, our interaction analyses suggest perhaps that sufficiently strong cultural exposure yields sustained religious commitment, even in the face of the putatively corrosive influence of cognitive reflection. Theoretically, these results fit well with dual inheritance theories of religion ##, as evolved cognitive capacities for cultural learning prove to be the most potent predictor of individual differences in the cross-culturally universal display of religious belief. In an applied sense, they also speak to the shared cognitive and cultural forces that generate, depending on circumstances, either belief or disbelief. Atheists are becoming increasingly common in the world, not because human psychology is fundamentally changing, but rather because evolved cognition remains stable in the face of a rapidly changing cultural context that is itself the product of a coevolutionary process. Faith emerges in some cultural contexts, and atheism is the natural result in others.

```{r individual scatters, echo=F, message=F, error=F}
# mentalizing

mp <- ggplot(dment_nc, aes(x=-1*ment_lo, y=-1*disbelief)) +
  labs(x='Advanced\nMentalizing', y= 'Belief') +
  geom_point(alpha=.2, position='jitter', color='darkred') +
  stat_smooth(method=lm, color='darkred') +
  theme_bw() +
  theme(text = element_text(family="Times"),
        axis.text = element_blank(),
        axis.ticks = element_blank(),
        axis.title.x = element_text(size = 20, color='darkred'),
        axis.title.y = element_text(size = 20),
        panel.grid.minor.y = element_blank(),
        panel.grid.minor.x = element_blank(),
        panel.grid.major.y = element_blank(),
        panel.grid.major.x = element_blank(),
        panel.background = element_blank(),
        plot.background = element_blank(),
        panel.border = element_rect(color="darkgrey")
  )

# motivation

sp <- ggplot(dsec_nc, aes(x=security, y=-1*disbelief)) +
  labs(x='Existential\nSecurity', y= 'Belief') +
  geom_point(alpha=.2, position='jitter', color='darkblue') +
  stat_smooth(method=lm, color='darkblue') +
  theme_bw() +
  theme(text = element_text(family="Times"),
        axis.text = element_blank(),
        axis.ticks = element_blank(),
        axis.title.x = element_text(size = 20, color='darkblue'),
        axis.title.y = element_text(size = 20),
        panel.grid.minor.y = element_blank(),
        panel.grid.minor.x = element_blank(),
        panel.grid.major.y = element_blank(),
        panel.grid.major.x = element_blank(),
        panel.background = element_blank(),
        plot.background = element_blank(),
        panel.border = element_rect(color="darkgrey")
  )

# CREDs

cp <- ggplot(dcred_nc, aes(x=-1*cred_lo, y=-1*disbelief)) +
  labs(x='Religious\nCREDs', y= 'Belief') +
  geom_point(alpha=.2, position='jitter', color='purple3') +
  stat_smooth(method=lm, color='purple3') +
  theme_bw() +
  theme(text = element_text(family="Times"),
        axis.text = element_blank(),
        axis.ticks = element_blank(),
        axis.title.x = element_text(size = 20, color='purple3'),
        axis.title.y = element_text(size = 20),
        panel.grid.minor.y = element_blank(),
        panel.grid.minor.x = element_blank(),
        panel.grid.major.y = element_blank(),
        panel.grid.major.x = element_blank(),
        panel.background = element_blank(),
        plot.background = element_blank(),
        panel.border = element_rect(color="darkgrey")
  )


# reflection cognitive style

rp <- ggplot(dref_nc, aes(x=reflection, y=-1*disbelief)) +
  labs(x='Cognitive\nReflection', y= 'Belief') +
  geom_point(alpha=.2, position='jitter', color='darkgreen') +
  stat_smooth(method=lm, color='darkgreen') +
  theme_bw() +
  theme(text = element_text(family="Times"),
        axis.text = element_blank(),
        axis.ticks = element_blank(),
        axis.title.x = element_text(size = 20, color='darkgreen'),
        axis.title.y = element_text(size = 20),
        panel.grid.minor.y = element_blank(),
        panel.grid.minor.x = element_blank(),
        panel.grid.major.y = element_blank(),
        panel.grid.major.x = element_blank(),
        panel.background = element_blank(),
        plot.background = element_blank(),
        panel.border = element_rect(color="darkgrey")
  )


ggarrange(mp, sp, cp, rp, 
          labels = c("A", "B", "C", "D"),
          ncol = 2, nrow = 2)
```

```{r individual tables, echo=FALSE}
zeros <- read.csv('zero-order-posteriors.csv')
zeros <- select(zeros, -X)

zero.m <- zeros %>% sapply(mean) %>% unname %>% round(digits = 2)
zero.l <- zeros %>% sapply(low) %>% unname %>% round(digits = 2)
zero.h <- zeros %>% sapply(high) %>% unname %>% round(digits = 2)
zero.pr <- zeros %>% sapply(biggerZero) %>% unname %>% round(digits = 2) 

pdi <- paste0('[', zero.l, ', ', zero.h, ']')


v <- c('Low Mentalizing', 'Mentalizing (quad)', 'High Security', 'Low CREDs', 'High Reflection')

zero.table <- data.frame(Variable = v, r = zero.m, HPDI= pdi, Pr = zero.pr)
zero.table$Pr[zero.table$Pr == 1] <- '>0.99'

zerotab <- zero.table %>%
  kable() %>%
  kable_styling(bootstrap_options = "striped", full_width = F, position = "float_right") %>%
  column_spec(1, bold = T)

zerotab

```

```{r interaction plot, echo=FALSE, warning=FALSE, message=FALSE}

dcrt_cred_cv <- select(d, disbelief, cred_lo, reflection, ageZ, educZ, femZ, social_consZ, econ_consZ, eXtra_m, Consc_m, Neuro_m, Agree_m, Open_m, Hum_m)
dcrt_cred_cv <- dcrt_cred_cv[complete.cases(dcrt_cred_cv),]

dcrt_cred_cv$belief <- dcrt_cred_cv$disbelief * -1
dcrt_cred_cv$cred <- dcrt_cred_cv$cred_lo * -1

leastcred <- min(dcrt_cred_cv$cred)
mostcred <- max(dcrt_cred_cv$cred)


meanCRED_a <- intx$a
meanCRED_b <- intx$b_ref
minCRED_a <- intx$b_cred*leastcred + intx$a
minCRED_b <- intx$b_ref + intx$b_int * leastcred
maxCRED_a <- intx$b_cred * mostcred + intx$a
maxCRED_b <- intx$b_ref + intx$b_int * mostcred

cred_crt <- data.frame(meanCRED_a, meanCRED_b, minCRED_a, minCRED_b, maxCRED_a, maxCRED_b)




# get means for lines

mean.int <- mean(cred_crt$meanCRED_a)
mean.slope <- mean(cred_crt$meanCRED_b)
min.int <- mean(cred_crt$minCRED_a)
min.slope <- mean(cred_crt$minCRED_b)
max.int <- mean(cred_crt$maxCRED_a)
max.slope <- mean(cred_crt$maxCRED_b)

# get 20 smaples of each

cred_crt <- cred_crt[sample(1:nrow(cred_crt)), ] #shuffle the deck

mean.20int <- c(cred_crt$meanCRED_a[1:100])
mean.20slope <- c(cred_crt$meanCRED_b[1:100])

min.20int <- c(cred_crt$minCRED_a[1:100])
min.20slope <- c(cred_crt$minCRED_b[1:100])

max.20int <- c(cred_crt$maxCRED_a[1:100])
max.20slope <- c(cred_crt$maxCRED_b[1:100])

# to plot this shizzle

d <- data.frame(x=c(min(dcrt_cred_cv$reflection), 0, max(dcrt_cred_cv$reflection)))

brange <- max(dcrt_cred_cv$reflection) - min(dcrt_cred_cv$reflection)

decs <- seq(from=0, to=1, by=.33)

b.breaks <- min(dcrt_cred_cv$reflection) + decs*brange


meancol <- 'black'
mincol <- 'purple'
maxcol <- 'hotpink'


ggplot(dcrt_cred_cv, aes(x=reflection, y=belief)) +
  geom_point(alpha=.05, position = 'jitter') +
  scale_x_continuous(breaks=b.breaks, labels=c(0, 3, 6, 9)) +
  labs(x="Cognitive Reflection\n(correct CRT items)", y="Belief") +
  geom_abline(slope=mean.20slope, intercept=mean.20int, lwd=.2, col=meancol, alpha=.15) +
  geom_abline(slope=min.20slope, intercept=min.20int, lwd=.2, col=mincol, alpha=.15) +
  geom_abline(slope=max.20slope, intercept=max.20int, lwd=.2, col=maxcol, alpha=.15) +
  geom_abline(slope=c(mean.slope, min.slope, max.slope), intercept=c(mean.int, min.int, max.int), col=c(meancol, mincol, maxcol), lwd=1.2) +
  annotate("text", x = 0.3, y = c(.7, 0.1, -1.2), label = c("Max CRED", "Mean CRED", "Min CRED"), hjust=0, vjust=0, size=6, color=c(maxcol, meancol, mincol), family = "Times") +
  theme_bw() +
  theme(text = element_text(family="Times"),
        axis.text = element_text(size = 16),
        axis.title = element_text(size = 20),
        panel.background = element_blank(),
        plot.background = element_blank(),
        axis.text.y = element_blank(),
        axis.ticks.y = element_blank(),
        panel.grid.major.x = element_blank() ,
        panel.grid.minor.x = element_blank() ,
        panel.grid.major.y = element_blank() ,
        panel.grid.minor.y = element_blank() ,
        panel.border = element_rect(color="darkgrey"),
        plot.margin = unit(c(1, 1, 1, 1), "lines")) 


```


```{r posterior plot, echo=FALSE, warning=FALSE, message=FALSE}
post.b <-  full_cv_post %>% select( 'Lower\nMentalizing\n\n\n' = b_ment, 'Existential\nSecurity\n\n\n' = b_sec, 'Fewer\nCREDs\n\n\n' = b_cred, 'Cognitive\nReflection\n\n\n' = b_ref) 

post.long.b <- gather( post.b, type, beta)

post.long.b$type <- factor(post.long.b$type, levels=c(  'Existential\nSecurity\n\n\n', 'Lower\nMentalizing\n\n\n','Cognitive\nReflection\n\n\n',  'Fewer\nCREDs\n\n\n'))


ggplot(post.long.b, aes(x = beta, y = type, fill = type)) +
  geom_vline(xintercept = 0, color='darkgrey') +
  geom_density_ridges(alpha = .7, scale = 1.9, rel_min_height = 0.01, size=0) +
  labs(x = '\nAssociation With Disbelief\n(standardized beta)') +
  scale_x_continuous(limits = c(-.1, .4)) +
  scale_y_discrete(expand = expand_scale(add = c(0.3, 2))) +
  scale_fill_manual(values = c('darkblue', 'darkred',   'darkgreen', 'purple3' )) +
  theme_bw() +
  theme(text = element_text(family="Times"),
        axis.text.x = element_text(size = 16),
        axis.text.y = element_text(size = 16, color = c('darkblue', 'darkred',   'darkgreen', 'purple3' )),
        axis.title = element_text(size = 20),
        axis.ticks = element_blank(),
        panel.grid.minor.y = element_blank(),
        panel.grid.major.y = element_blank(),
        panel.grid.minor.x = element_blank(),
        legend.position = "none",
        panel.background = element_blank(),
        plot.background = element_blank(),
        panel.border = element_rect(color="darkgrey"),
        axis.title.y = element_blank()
  )


```


```{r full model table, echo=FALSE}


fullPost <- full_cv_post %>% select(-X, -a, -sigma)

fullPost$b_female <- fullPost$b_female * -1 # reverse to score for male = disbelief
fullPost$b_social_cons <- fullPost$b_social_cons * -1 # reverse so social lib = disbelief
fullPost$b_Agree <- fullPost$b_Agree * -1 #reverse so low aggreable = disbelief


beta <- fullPost %>% sapply(mean) %>% unname %>% round(digits=2)
beta.l <- fullPost %>% sapply(low) %>% unname %>% round(digits=2)
beta.h <- fullPost %>% sapply(high) %>% unname %>% round(digits=2)
hpdi <- paste0('[', beta.l, ', ', beta.h, ']')
Pr0 <- fullPost %>% sapply(biggerZero) %>% unname %>% round(digits=2)

pred <- c('Low Mentalizing', 'Mentalizing (quad)', 'Security', 'Low CREDs', 'Reflection', 'Age', 'Education', 'Male', 'Social Lib', 'Economic Cons', 'Extraversion', 'Conscientiousness', 'Neuroticism', 'Low Agreeableness', 'Openness', 'Honesty/Humility')

fulltab <- data.frame(Variable = pred, Beta = beta, HPDI = hpdi, Pr = Pr0 )
fulltab$Pr[fulltab$Pr == 1] <- '> 0.99'
fulltab$Pr[fulltab$Pr == 0] <- '< 0.01'



kable(fulltab, booktabs= T, caption = "Full Model Summary") %>%
   kable_styling(full_width = F) %>%
   add_indent(6:16)
```


```{r predictions table, echo=F}
model <- c('Secularization', 'Cognitive Byproduct', 'Social Learning', 'Dual Inheritance')
dis <- c('Sociology & Social Psych', 'Ev Psych & Cog Sci Rel', 'Cultural Evolution', 'Gene-Culture Coevolution')
ment <- c(' ', '+ +', ' ', '+')
sec <- c('+ + + +', '+', ' ',  'indirect')
cred <- c(' ', ' ', '+ + + +', '+ + + +')
ref <- c(' ', '+ + +', ' ', '+')

predtab <- data.frame(
  Theory = model, Discipline = dis, 
  'Mindblind' = ment, 
  'Apatheist' = sec,
  'inCREDulous' = cred,
  'Analytic' = ref)

 
kable(predtab, booktabs= T, caption = "Predictions From Prominent  Theories", align = "r") %>%
   column_spec(1, bold = T) %>%
   kable_styling(full_width = T) 
```

