---
title: "Supplement: Origins of Disbelief"

output:
  pdf_document:
    toc: true
    toc_depth: 2
 # html_document:
  #  df_print: paged
bibliography: BAMLabLib.bib
csl: nature.csl
header-includes:
   - \usepackage{draftwatermark}
   - \usepackage{setspace}\doublespacing
   - \usepackage{lineno}
   - \linenumbers
   - \usepackage{fancyhdr}
   - \pagestyle{fancy}
   - \fancyhead[R]{Supplement}
   - \usepackage{footnote}
   - \renewcommand{\thefootnote}{\roman{footnote}}
indent: true
author:
   - Will M. Gervais^[University of Kentucky, Psychology, will.gervais@gmail.com]
   - Maxine B. Najle^[Blue Labs Analytics, Washington, D.C.]
   - Sarah R. Schiavone^[University of California-Davis, Psychology]
   - Nava Caluori^[University of Virginia, Psychology]

date: "Preprint from `r format(Sys.time(), '%d %B %Y')`"
---
\SetWatermarkText{SUPPLEMENT}
\SetWatermarkLightness{.97}

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r packages, echo=FALSE, results='hide', warning=FALSE, message=FALSE}
library(rethinking)
library(tidyverse)
```

```{r functions, echo=FALSE}
# handy functions ----


bigger <- function(first, second) {
  pr.big <- mean(ifelse(first > second, 1, 0))
  return(pr.big)
}

biggerZero <- function(input) {
  pr.big <- mean(ifelse(input > 0, 1, 0))
  return(pr.big)
}


# a couple of quick functions for pulling HPDIs


low <- function(x){
  v <- HPDI(x, prob=.97)[1]
  return(v)
}


high <- function(x){
  v <- HPDI(x, prob=.97)[2]
  return(v)
}

```

```{r data wrangling, echo=F}
# get data ----
go <- read.csv('go.csv')

go$disbelief <- go$sbs_m * -1
go$ment_lo <- go$pt_m * -1
go$cred_lo <- go$cred_m * -1
go$security <- go$mot_m * -1
go$reflection <- go$crtZ
go$ageZ <- scale(go$age, center=T, scale=T)[,]
go$educZ <- scale(go$educ, center=T, scale=T)[,]
go$femZ <- scale(go$female, scale=T, center = T)[,]
go$econ_consZ <- scale(go$econ_cons, center=T, scale=T)[,]
go$social_consZ <- scale(go$social_cons, center=T, scale=T)[,]


d <- select(go, 
            disbelief, 
            ment_lo, 
            security, 
            cred_lo, 
            reflection,
            ageZ, educZ, femZ, econ_consZ, social_consZ, eXtra_m, Consc_m, Neuro_m, Agree_m, Open_m, Hum_m)


# Lower advanced mentalizing ----
# with covariates
dment_cv <- select(d, disbelief, ment_lo, ageZ, educZ, femZ, social_consZ, econ_consZ, eXtra_m, Consc_m, Neuro_m, Agree_m, Open_m, Hum_m)
dment_cv <- dment_cv[complete.cases(dment_cv),]
# without
dment_nc <- select(d, disbelief, ment_lo)
dment_nc <- dment_nc[complete.cases(dment_nc),]


# existential security ----
# with covariates
dsec_cv <- select(d, disbelief, security, ageZ, educZ, femZ, social_consZ, econ_consZ, eXtra_m, Consc_m, Neuro_m, Agree_m, Open_m, Hum_m)
dsec_cv <- dsec_cv[complete.cases(dsec_cv),]
# sec no covariates
dsec_nc <- select(d, disbelief, security)
dsec_nc <- dsec_nc[complete.cases(dsec_nc),]

# Fewer CREDS ----
# with covariates
dcred_cv <- select(d, disbelief, cred_lo, ageZ, educZ, femZ, social_consZ, econ_consZ, eXtra_m, Consc_m, Neuro_m, Agree_m, Open_m, Hum_m)
dcred_cv <- dcred_cv[complete.cases(dcred_cv),]
# cred no covariates
dcred_nc <- select(d, disbelief, cred_lo)
dcred_nc <- dcred_nc[complete.cases(dcred_nc),]

# cognitive reflection ----
# with covariates
dref_cv <- select(d, disbelief, reflection, ageZ, educZ, femZ, social_consZ, econ_consZ, eXtra_m, Consc_m, Neuro_m, Agree_m, Open_m, Hum_m)
dref_cv <- dref_cv[complete.cases(dref_cv),]
# ref no covariates
dref_nc <- select(d, disbelief, reflection)
dref_nc <- dref_nc[complete.cases(dref_nc),]

# II. Relative contributions ----
#  5.	We will run a model with all four factors predicting religion.

# with covariates
dfull_cv <- select(d, disbelief, ment_lo, security, cred_lo, reflection, ageZ, educZ, femZ, social_consZ, econ_consZ, eXtra_m, Consc_m, Neuro_m, Agree_m, Open_m, Hum_m)
dfull_cv <- dfull_cv[complete.cases(dfull_cv),]
# full no covariates
dfull_nc <- select(d, disbelief, ment_lo, security, cred_lo, reflection)
dfull_nc <- dfull_nc[complete.cases(dfull_nc),]

# crt * cred, w/ covariates
dcrt_cred_cv <- select(d, disbelief, cred_lo, reflection, ageZ, educZ, femZ, social_consZ, econ_consZ, eXtra_m, Consc_m, Neuro_m, Agree_m, Open_m, Hum_m)
dcrt_cred_cv <- dcrt_cred_cv[complete.cases(dcrt_cred_cv),]

# mentalizing interactions ----

```

``` {r run models, echo=FALSE, results='hide', warning=FALSE, message=FALSE}
# mentalizing with covariates
ment_cv <- map2stan(
  alist(
    disbelief ~ dnorm(mu, sigma),
    mu <- a + b_ment*ment_lo + b_mentQuad*ment_lo^2 + b_age*ageZ + b_educ*educZ + b_female*femZ + b_social_cons*social_consZ + b_econ_cons*econ_consZ + b_eXtra*eXtra_m + b_Consc*Consc_m + b_Neuro*Neuro_m + b_Agree*Agree_m  + b_Open*Open_m + b_Hum*Hum_m,
    c(a, b_ment, b_mentQuad, b_age, b_educ, b_female, b_social_cons, b_econ_cons, b_eXtra, b_Consc, b_Neuro, b_Agree, b_Open, b_Hum) ~ dnorm(0,1),
    sigma ~ dcauchy(0, 1)
  ), data=dment_cv, WAIC = F, chains = 1, cores = 1,
  iter = 3000, warmup = 2000
)
ment_cv_post <- as.data.frame(extract.samples(ment_cv))

# security with covariates
sec_cv <- map2stan(
  alist(
    disbelief ~ dnorm(mu, sigma),
    mu <- a + b_sec*security + b_age*ageZ + b_educ*educZ + b_female*femZ + b_social_cons*social_consZ + b_econ_cons*econ_consZ + b_eXtra*eXtra_m + b_Consc*Consc_m + b_Neuro*Neuro_m + b_Agree*Agree_m  + b_Open*Open_m + b_Hum*Hum_m,
    c(a, b_sec, b_age, b_educ, b_female, b_social_cons, b_econ_cons, b_eXtra, b_Consc, b_Neuro, b_Agree, b_Open, b_Hum) ~ dnorm(0,1),
    sigma ~ dcauchy(0, 1)
  ), data=dsec_cv, WAIC = F, chains = 1, cores = 1,
  iter = 3000, warmup = 2000, control=list(adapt_delta=0.9)
)
sec_cv_post <- as.data.frame(extract.samples(sec_cv))

# low CREDs with covariates
cred_cv <- map2stan(
  alist(
    disbelief ~ dnorm(mu, sigma),
    mu <- a + b_cred*cred_lo + b_age*ageZ + b_educ*educZ + b_female*femZ + b_social_cons*social_consZ + b_econ_cons*econ_consZ + b_eXtra*eXtra_m + b_Consc*Consc_m + b_Neuro*Neuro_m + b_Agree*Agree_m  + b_Open*Open_m + b_Hum*Hum_m,
    c(a, b_cred, b_age, b_educ, b_female, b_social_cons, b_econ_cons, b_eXtra, b_Consc, b_Neuro, b_Agree, b_Open, b_Hum) ~ dnorm(0,1),
    sigma ~ dcauchy(0, 1)
  ), data=dcred_cv, WAIC = F, chains = 1, cores = 1,
  iter = 3000, warmup = 2000, control=list(adapt_delta=0.9)
)
cred_cv_post <- as.data.frame(extract.samples(cred_cv))

# reflection with covariates
ref_cv <- map2stan(
  alist(
    disbelief ~ dnorm(mu, sigma),
    mu <- a + b_ref*reflection + b_age*ageZ + b_educ*educZ + b_female*femZ + b_social_cons*social_consZ + b_econ_cons*econ_consZ + b_eXtra*eXtra_m + b_Consc*Consc_m + b_Neuro*Neuro_m + b_Agree*Agree_m  + b_Open*Open_m + b_Hum*Hum_m,
    c(a, b_ref, b_age, b_educ, b_female, b_social_cons, b_econ_cons, b_eXtra, b_Consc, b_Neuro, b_Agree, b_Open, b_Hum) ~ dnorm(0,1),
    sigma ~ dcauchy(0, 1)
  ), data=dref_cv, WAIC = F, chains = 1, cores = 1,
  iter = 3000, warmup = 2000, control=list(adapt_delta=0.9)
)
ref_cv_post <- as.data.frame(extract.samples(ref_cv))


```
\pagebreak
# Preregistration

We preregistered a series of analyses. Here, we lay out models and model summaries for all of these analyses. Here's what we preregistered:

> "We will perform a series of 7 confirmatory tests on the full sample. Each model will be run twice: first with no covariates, then including age, gender, politics, education, & personality as covariates."


This entails a series of models:

1. Does each factor independently replicate?
   1.	We will replicate mentalizing in a model with mentalizing (linear and quadratic terms) predicting religion.
   2.	We will replicate motivation in a model with the motivation items predicting religion.
   3.  We will replicate cultural learning in a model with CREDs predicting religion. 
   4.  We will replicate cognitive style in a model with the CRT predicting religion.
2. Relative contributions?
   5.	We will run a model with all four factors predicting religion.
3. Specific hypothesized interactions?
   6.	To test whether cognitive styleâ€™s effects differ across cultural learning, we will have a model in which CRT, CREDs, and their interaction predict religion.
   7.	To test the hypothesis that mentalizing is especially important in the context of cultural learning and motivation, we will have a model with mentalizing, CREDs, motivation and the mentalizing-by-CREDs and mentalizing-by-motivation interaction terms predicting religion.
   
The main manuscript summarizes: our full model (all four primary predictors plus covariates), a binary full model, the cultural learning-by-cognitive reflection interaction with covariates, and essentially zero-order replication analyses. Here, we spell out all preregistered analyses not already included. 

# 1. Does each factor independently replicate?

## 1. We will replicate mentalizing in a model with mentalizing (linear and quadratic terms) predicting religion.

### With covariates

As the model without covariates is already summarized in the main document, here is the model including covariates. Nothing much changes from the main model reported in the main paper.

```{r ment table, echo=FALSE, warning=FALSE, message=FALSE}

mentPost <- ment_cv_post %>% select(-X, -a, -sigma)
mentPost$b_female <- mentPost$b_female * -1 # reverse to score for male = disbelief
mentPost$b_social_cons <- mentPost$b_social_cons * -1 # reverse so social lib = disbelief
mentPost$b_Agree <- mentPost$b_Agree * -1 #reverse so low aggreable = disbelief


beta <- mentPost %>% sapply(mean) %>% unname %>% round(digits = dig)
beta.l <- mentPost %>% sapply(low) %>% unname %>% round(digits = dig)
beta.h <- mentPost %>% sapply(high) %>% unname %>% round(digits = dig)
hpdi <- paste0('[', beta.l, ', ', beta.h, ']')
Pr0 <- mentPost %>% sapply(biggerZero) %>% unname

pred <- c('mindblind', 'mentalizing (quad)', 'Age', 'Education', 'Male', 'Social Lib', 'Economic Cons', 'Extraversion', 'Conscientiousness', 'Neuroticism', 'Low Agreeableness', 'Openness', 'Honesty/Humility')

menttab <- data.frame(Variable = pred, Beta = beta, HPDI = hpdi, Pr = Pr0 )
menttab$Pr[menttab$Pr == 1] <- '> 0.99'
menttab$Pr[menttab$Pr == 0] <- '< 0.01'



kable(menttab, booktabs= T, caption = "Predicting Disbelief: ment Model Summary", align=c("l", "r", "r", "r")) %>%
   kable_styling(ment_width = F, position = "center") %>%
   footnote(general = " ", number = c("Mentalizing (quad) = quadratic effect of mentalizing", "Beta = standardized beta", "HPDI = 97% Highest posterior density interval", "Pr = posterior probability of Beta > 0"))
   
```










