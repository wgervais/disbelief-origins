---
title: "Supplement: Origins of Disbelief"

output:
  pdf_document:
    toc: true
    toc_depth: 2
 # html_document:
  #  df_print: paged
bibliography: BAMLabLib.bib
csl: nature.csl
header-includes:
   - \usepackage{draftwatermark}
   - \usepackage{setspace}\doublespacing
   - \usepackage{lineno}
   - \linenumbers
   - \usepackage{fancyhdr}
   - \pagestyle{fancy}
   - \fancyhead[R]{Supplement}
   - \usepackage{footnote}
   - \renewcommand{\thefootnote}{\roman{footnote}}
indent: true
author:
   - Will M. Gervais^[University of Kentucky, Psychology, will.gervais@gmail.com]
   - Maxine B. Najle^[Blue Labs Analytics, Washington, D.C.]
   - Sarah R. Schiavone^[University of California-Davis, Psychology]
   - Nava Caluori^[University of Virginia, Psychology]

date: "Preprint from `r format(Sys.time(), '%d %B %Y')`"
---
\SetWatermarkText{SUPPLEMENT}
\SetWatermarkLightness{.97}

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```

```{r packages, echo=FALSE, results='hide', warning=FALSE, message=FALSE}
library(rethinking)
library(tidyverse)
library(kableExtra)
```

```{r functions, echo=FALSE}

dig <- 2


bigger <- function(first, second) {
  pr.big <- ifelse(first > second, 1, 0) %>% mean %>% round(digits = dig)
  return(pr.big)
}

biggerZero <- function(input) {
  pr.big <- ifelse(input > 0, 1, 0) %>% mean(na.rm=T) %>% round(digits = dig)
return(pr.big)
}



# a couple of quick functions for pulling HPDIs


low <- function(x){
  v <- HPDI(x, prob=.97)[1]
  return(v)
}


high <- function(x){
  v <- HPDI(x, prob=.97)[2]
  return(v)
}


printB <- function(input) {
  p <- input %>% mean(na.rm=T) %>% round(digits = dig)
  l <- input %>% low %>% round(digits = dig)
  h <- input %>% high %>% round(digits = dig)
paste0(p, ", [", l, ", ", h, "]")
}



getA <- function(input){
  theA <- psych::alpha(input, na.rm=T)$total[2] %>% unname %>% round(digits = dig)
  return(theA)
}
```


\pagebreak
# The Preregistration

We preregistered a series of analyses. Here, we lay out models and model summaries for all of these analyses. Here's what we preregistered:

> "We will perform a series of 7 confirmatory tests on the full sample. Each model will be run twice: first with no covariates, then including age, gender, politics, education, & personality as covariates."


This entails a series of models:

1. Does each factor independently replicate?
   1.	We will replicate mentalizing in a model with mentalizing (linear and quadratic terms) predicting religion.
   2.	We will replicate motivation in a model with the motivation items predicting religion.
   3.  We will replicate cultural learning in a model with CREDs predicting religion. 
   4.  We will replicate cognitive style in a model with the CRT predicting religion.
2. Relative contributions?
   5.	We will run a model with all four factors predicting religion.
3. Specific hypothesized interactions?
   6.	To test whether cognitive styleâ€™s effects differ across cultural learning, we will have a model in which CRT, CREDs, and their interaction predict religion.
   7.	To test the hypothesis that mentalizing is especially important in the context of cultural learning and motivation, we will have a model with mentalizing, CREDs, motivation and the mentalizing-by-CREDs and mentalizing-by-motivation interaction terms predicting religion.
   
The main manuscript summarizes: our full model (all four primary predictors plus covariates), a binary full model, the cultural learning-by-cognitive reflection interaction with covariates, and essentially zero-order replication analyses. Here, we spell out preregistered analyses not already included. 

## Mentalizing: Quadratic Term
We initially preregistered inclusion of quadratic terms for mentalizing to test for the possibility that only extreme low advanced mentalizing is associated with disbelief. After the preregistration but before data collection and analysis, we realized that the polynomial approach was a very poor test of this idea and invites model overfitting [@mcelreathStatisticalRethinkingBayesian2016]. The preregistered model including a quadratic for mentalizing was theoretically dubious and statistically naive, so we left it out of main analyses. We checked a few of the primary models to see if inclusion of a quadratic did much. It did not. Information criteria suggested that models were always better without a quadratic term for mentalizing, and the quadratic term itself never amounted to much. Additional exploration about a possible low-range mentalizing blip in atheism may warrant future research with a statistically appropriate model.

\pagebreak
# 1. Individual Replications

As the models without covariates are already summarized in the main document, here is the summary for each model including covariates. Nothing much changes from the main models reported in the main paper. inCREDulous atheism and analytic atheism still repicate soundly, and mindblind atheism is also fairly evident. Apatheism is still essentially absent. Table 1 summarizes the individual replication results.

```{r replications table, echo=FALSE, warning=FALSE, message=FALSE}

zeros.cv <- read.csv('zero-order-posteriors-cv.csv')
zeros.cv <- select(zeros.cv, -X)

zero.m <- zeros.cv %>% sapply(mean) %>% unname %>% round(digits = dig)
zero.l <- zeros.cv %>% sapply(low) %>% unname %>% round(digits = dig)
zero.h <- zeros.cv %>% sapply(high) %>% unname %>% round(digits = dig)
zero.pr <- zeros.cv %>% sapply(biggerZero) %>% unname %>% round(digits = dig)

pdi <- paste0('[', zero.l, ', ', zero.h, ']')


v <- c('mindblind', 'apatheism', 'inCREDulous', 'analytic')

zero.table <- data.frame(Variable = v, Beta = zero.m, HPDI= pdi, Pr = zero.pr)
zero.table$Pr[zero.table$Pr == 1] <- '>0.99'

kable(zero.table, booktabs= T, caption = "Predicting Disbelief: Individual Replication Analyses With Covariates", align = c("l", "r", "r", "r")) %>%
   kable_styling(full_width = F, position = "center") %>%
   footnote(general = " ", number = c("Beta = standardized beta", "HPDI = 97% Highest posterior density interval", "Pr = posterior probability of Beta > 0"))

```

\pagebreak
# 2. Relative Contributions

The main document includes a full model with all key predictors and covariates predicting disbelief. Here, we report the model sans covariates for completeness with the preregistration. Again, not much changes. In this case, mindblind atheism appears even less important. Table 2 summarizes this model.

```{r relative model, echo=FALSE, warning=FALSE, message=FALSE, results='hide'}
# get data 
go <- read.csv('go.csv')

go$disbelief <- go$sbs_m * -1
go$ment_lo <- go$pt_m * -1
go$cred_lo <- go$cred_m * -1
go$security <- go$mot_m * -1
go$reflection <- go$crtZ
go$ageZ <- scale(go$age, center=T, scale=T)[,]
go$educZ <- scale(go$educ, center=T, scale=T)[,]
go$femZ <- scale(go$female, scale=T, center = T)[,]
go$econ_consZ <- scale(go$econ_cons, center=T, scale=T)[,]
go$social_consZ <- scale(go$social_cons, center=T, scale=T)[,]


d <- select(go, 
            disbelief, 
            ment_lo, 
            security, 
            cred_lo, 
            reflection,
            ageZ, educZ, femZ, econ_consZ, social_consZ, eXtra_m, Consc_m, Neuro_m, Agree_m, Open_m, Hum_m)


dfull_nc <- d %>% select(disbelief, ment_lo, security, cred_lo, reflection) %>% drop_na()

full_nc <- map2stan(
  alist(
    disbelief ~ dnorm(mu, sigma),
    mu <- a + b_ment*ment_lo + b_sec*security + b_cred*cred_lo + b_ref*reflection,
    c(a, b_ment, b_sec, b_cred, b_ref) ~ dnorm(0,1),
    sigma ~ dcauchy(0, 1)
  ), data=dfull_nc, WAIC = F, chains = 1, cores = 1,
  iter = 13000, warmup = 1000
)

full_nc_post <- as.data.frame(extract.samples(full_nc))

```

```{r relative table, echo=FALSE, message=FALSE, warning=FALSE}


full.ncs <- select(full_nc_post, b_ment, b_sec, b_cred, b_ref)

full.nc.m <- full.ncs %>% sapply(mean) %>% unname %>% round(digits = dig)
full.nc.l <- full.ncs %>% sapply(low) %>% unname %>% round(digits = dig)
full.nc.h <- full.ncs %>% sapply(high) %>% unname %>% round(digits = dig)
full.nc.pr <- full.ncs %>% sapply(biggerZero) %>% unname %>% round(digits = dig)

pdi <- paste0('[', full.nc.l, ', ', full.nc.h, ']')


v <- c('mindblind', 'apatheism', 'inCREDulous', 'analytic')

full.nc.table <- data.frame(Variable = v, Beta = full.nc.m, HPDI= pdi, Pr = full.nc.pr)
full.nc.table$Pr[full.nc.table$Pr == 1] <- '>0.99'

kable(full.nc.table, booktabs= T, caption = "Full Model, No Covariates", align = c("l", "r", "r", "r")) %>%
   kable_styling(full_width = F, position = "center") %>%
   footnote(general = " ", number = c("Beta = standardized beta", "HPDI = 97% Highest posterior density interval", "Pr = posterior probability of Beta > 0"))

```


```{r mindblind intx, echo=FALSE, message=FALSE, warning=FALSE, results='hide'}
dmentint_cv <- select(d, disbelief, ment_lo, security, cred_lo, ageZ, educZ, femZ, social_consZ, econ_consZ, eXtra_m, Consc_m, Neuro_m, Agree_m, Open_m, Hum_m)
dmentint_cv <- dmentint_cv[complete.cases(dmentint_cv),]

mentint_cv <- map2stan(
  alist(
    disbelief ~ dnorm(mu, sigma),
    mu <- a + b_mc_int*ment_lo*cred_lo + b_mm_int*ment_lo*security + b_ment*ment_lo + b_sec*security + b_cred*cred_lo + b_age*ageZ + b_educ*educZ + b_female*femZ + b_social_cons*social_consZ + b_econ_cons*econ_consZ + b_eXtra*eXtra_m + b_Consc*Consc_m + b_Neuro*Neuro_m + b_Agree*Agree_m  + b_Open*Open_m + b_Hum*Hum_m,
    c(a, b_mc_int, b_mm_int,  b_ment, b_sec, b_cred, b_age, b_educ, b_female, b_social_cons, b_econ_cons, b_eXtra, b_Consc, b_Neuro, b_Agree, b_Open, b_Hum) ~ dnorm(0,1),
    sigma ~ dcauchy(0, 1)
  ), data=dmentint_cv, WAIC = F, chains = 1, cores = 1,
  iter = 13000, warmup = 1000
)

mentint <- as.data.frame(extract.samples(mentint_cv, n=145000))

```

\pagebreak
# 3. Interactions: Mindblind Atheism

We pursued speculation that mindblind atheism might be especially pronounced in contexts in which other pathways to atheism are muted. If this is the case, for example, then we might expect interactions between mindblind atheism and both cultural exposure to religion and existential security, such that mindblind atheism would be more evident among people relatively higher in religious CREDs or lower in existential security. Alas, we did't find much of any interactions between mindblind atheism and inCREDulous atheism, $\beta$ = `r  printB(mentint$b_mc_int)`, $\mathrm{P}(\beta > 0 \mid data)$ = `r biggerZero(mentint$b_mc_in)` or with apatheism, $\beta$ = `r  printB(mentint$b_mm_int)`, $\mathrm{P}(\beta > 0 \mid data)$ = `r biggerZero(mentint$b_mm_in)`. This is in a sense unsurprising because mindblind atheism was not especially robust across alternative models throughout this project.







