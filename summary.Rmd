---
title: "Origins of Disbelief Summary"
author: "Will Gervais"
date: "10/31/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(rethinking)
library(tidyverse)
library(ggridges)
library(xtable)

# get data ----
go <- read.csv('go.csv')

go$disbelief <- go$sbs_m * -1
go$ment_lo <- go$pt_m * -1
go$cred_lo <- go$cred_m * -1
go$security <- go$mot_m * -1
go$reflection <- go$crtZ
go$ageZ <- scale(go$age, center=T, scale=T)[,]
go$educZ <- scale(go$educ, center=T, scale=T)[,]
go$femZ <- scale(go$female, scale=T, center = T)[,]
go$econ_consZ <- scale(go$econ_cons, center=T, scale=T)[,]
go$social_consZ <- scale(go$social_cons, center=T, scale=T)[,]
summary(go)

d <- select(go, 
            disbelief, 
            ment_lo, 
            security, 
            cred_lo, 
            reflection,
            ageZ, educZ, femZ, econ_consZ, social_consZ, eXtra_m, Consc_m, Neuro_m, Agree_m, Open_m, Hum_m)


full_cv_post <- read.csv('full-posterior.csv')

# zero orders
dment_nc <- select(d, disbelief, ment_lo)
dment_nc <- dment_nc[complete.cases(dment_nc),]

dsec_nc <- select(d, disbelief, security)
dsec_nc <- dsec_nc[complete.cases(dsec_nc),]

dcred_nc <- select(d, disbelief, cred_lo)
dcred_nc <- dcred_nc[complete.cases(dcred_nc),]

dref_nc <- select(d, disbelief, reflection)
dref_nc <- dref_nc[complete.cases(dref_nc),]


# combined zero order posteriors
zeros <- read.csv('zero-order-posteriors.csv')

# full posterior, long
full_cv_post <- read.csv('full-posterior.csv')

# interactions
intx <- read.csv('CrtCREDPost.csv')

# handy functions ----


bigger <- function(first, second) {
  pr.big <- mean(ifelse(first > second, 1, 0))
  return(pr.big)
}

biggerZero <- function(input) {
  pr.big <- mean(ifelse(input > 0, 1, 0))
  return(pr.big)
}


# a couple of quick functions for pulling HPDIs


low <- function(x){
  v <- HPDI(x, prob=.97)[1]
  return(v)
}


high <- function(x){
  v <- HPDI(x, prob=.97)[2]
  return(v)
}




library(kableExtra)

```

## Some Background Shit

Religion is a core component of human nature, yet a comprehensive scientific account of religion also needs to account for religious disbelief. Despite potentially drastic overreporting of religiosity, a third of the world’s 7 billion human inhabitants may actually be atheists—merely people who do not believe in God or gods. The origins of disbelief thus present a key testing ground for theories of religion. Here, we evaluate the predictions of four theoretical approaches to the origins of disbelief.

To currently believe in a god, one 1) must be able to mentally represent gods, 2) must be motivated to ‘interact’ with gods, 3) must receive credible cultural cues that some gods are real, and 4) must intuitively maintain this belief over time. Tweaks to any of these four components may instead yield disbelief in gods. Separate lines of research partially support this supposition. First, individual differences in mentalizing abilities (one key component of mind perception) predict religious disbelief ## in at least some samples. Second, although religion flourishes where life is unstable, existential security predicts reduced religiosity ##. Third, lack of credibility enhancing displays (CREDs) that one ought to believe in any gods is a good global predictor of atheism. Finally, people who reflectively override their intuitions tend to be less religious than those who ‘go with their guts’, although the magnitude and consistency of this relation is debatable. Although these four factors relate to religious disbelief in isolation, little work considers their operation in conjunction.

Different theoretical approaches make divergent predictions about which of these four factors are the most potent predictors of religious disbelief. First, secularization models posit that increases in existential security (wealth, health, education) reduce religious motivation; this approach is common in sociology of religion and in social psychology, under the banner of compensatory control. Second, evolutionary psychology and cognitive science of religion often view religion as a cognitive byproduct of other mental adaptations, such as mind perception or predator detection. In this view, challenges in the core cognitive faculties underlying such adaptations (e.g., mentalizing) would predict disbelief, as would people being able to override their religious intuitions via cognitive reflection. Third, cultural evolutionary models highlight the social learning processes underpinning religious belief and disbelief, and largely predict that context-biased social learning such as CREDs would be strongly associated with degrees of religious belief. Finally, dual inheritance models somewhat integrate these various perspectives, and predict that CREDs would be most important, followed by other factors such as cognitive reflection, mentalizing, and existential security. Table 1 depicts predictions derived from each of these perspectives. By simultaneously considering mentalizing, existential security, CREDs, and cognitive reflection, we are able to evaluate the suitability of each of these four theoretical approaches for understanding the psychological origins of religious disbelief.



```{r predictions, echo=F}
model <- c('Secularization', 'Cognitive Byproduct', 'Social Learning', 'Dual Inheritance')
dis <- c('Sociology & Social Psych', 'Ev Psych & Cog Sci Rel', 'Cultural Evolution', 'Gene-Culture Coevolution')
ment <- c(' ', 'medium', ' ', 'weak')
sec <- c('STRONG', 'weak', ' ',  'indirect')
cred <- c(' ', ' ', 'STRONG', 'STRONG')
ref <- c(' ', 'Strong', ' ', 'weak')

predtab <- data.frame(
  Theory = model, Discipline = dis, 
  'Low Mentalizing' = ment, 
  'High Security' = sec,
  'Low CREDs' = cred,
  'High Reflection' = ref)

 predictMe <- predtab %>%
  kable() %>%
  kable_styling(bootstrap_options = "striped", full_width = F, position = "left") %>%
  column_spec(1, bold = T) %>%
  add_header_above(c(" " = 2, "What Predicts Disbelief?" = 4))

predictMe
```

## Really Basic Methods

We preregistered a set of analyses that pit secularization, cognitive byproduct, socialization, and dual inheritance models against each other. Specifically, we posed three broad questions:

***I.	What are the relative contributions of each factor when considered simultaneously?***

***II.	How do the factors interact with each other in predicting belief and disbelief?***

***III.	Does early work on each individual factor successfully replicate in a nationally representative sample?***

To approach these questions, we contracted a nationally representative sample of USA adults (N= 1417) from GfK. Primarily, we were interested in predicting degrees of religious belief and disbelief with measures of 1) advanced mentalizing, 2) existential security, 3) theoretically modeled cues of cultural exposure to credible cues of religiosity (CREDs), and 4) intuitive versus reflective cognitive style. For robustness, we also included a number of demographic and psychological covariates.

```{r full model table, echo=FALSE}


fullPost <- full_cv_post %>% select(-X, -a, -sigma)

fullPost$b_female <- fullPost$b_female * -1 # reverse to score for male = disbelief
fullPost$b_social_cons <- fullPost$b_social_cons * -1 # reverse so social lib = disbelief
fullPost$b_Agree <- fullPost$b_Agree * -1 #reverse so low aggreable = disbelief


beta <- fullPost %>% sapply(mean) %>% unname %>% round(digits=2)
beta.l <- fullPost %>% sapply(low) %>% unname %>% round(digits=2)
beta.h <- fullPost %>% sapply(high) %>% unname %>% round(digits=2)
hpdi <- paste0('[', beta.l, ', ', beta.h, ']')
Pr0 <- fullPost %>% sapply(biggerZero) %>% unname %>% round(digits=2)

pred <- c('Low Mentalizing', 'Mentalizing (quad)', 'Security', 'Low CREDs', 'Reflection', 'Age', 'Education', 'Male', 'Social Lib', 'Economic Cons', 'Extraversion', 'Conscientiousness', 'Neuroticism', 'Low Agreeableness', 'Openness', 'Honesty/Humility')

fulltab <- data.frame(Variable = pred, Beta = beta, HPDI = hpdi, Pr = Pr0 )
fulltab$Pr[fulltab$Pr == 1] <- '> 0.99'
fulltab$Pr[fulltab$Pr == 0] <- '< 0.01'

posttab <- fulltab %>%
  kable() %>%
  kable_styling(bootstrap_options = "striped", full_width = F, position = "float_right") %>%
  column_spec(1, bold = T)

posttab
```
## Quick Results Summary

### Relative Contributions

Our most important analyses considered the relative contributions of all four factors operating in concert. As preregistered, we report two analyses in which the four core factors predict individual differences in belief and disbelief, both in the presence and absence of additional covariates. In our full model (see Table 2 and Figure 1), few credible displays of faith proved to be by far the most powerful predictor of religious disbelief. Credibility enhancing displays of faith predict belief, and their absence predicts atheism. Cognitive reflection remained a consistent predictor of religious disbelief, but following earlier cross-cultural work its predictive power was quite meager. Mentalizing challenges were only weakly associated, if at all, with disbelief, and existential security predicted essentially nothing.



```{r posterior plot, echo=FALSE, warning=FALSE, message=FALSE}
post.b <-  full_cv_post %>% select( 'Lower\nMentalizing\n\n\n' = b_ment, 'Existential\nSecurity\n\n\n' = b_sec, 'Fewer\nCREDs\n\n\n' = b_cred, 'Cognitive\nReflection\n\n\n' = b_ref) 

post.long.b <- gather( post.b, type, beta)

post.long.b$type <- factor(post.long.b$type, levels=c(  'Existential\nSecurity\n\n\n', 'Lower\nMentalizing\n\n\n','Cognitive\nReflection\n\n\n',  'Fewer\nCREDs\n\n\n'))


ggplot(post.long.b, aes(x = beta, y = type, fill = type)) +
  geom_vline(xintercept = 0, color='darkgrey') +
  geom_density_ridges(alpha = .7, scale = 1.9, rel_min_height = 0.01, size=0) +
  labs(x = '\nAssociation With Disbelief\n(standardized beta)') +
  scale_x_continuous(limits = c(-.1, .4)) +
  scale_y_discrete(expand = expand_scale(add = c(0.3, 2))) +
  scale_fill_manual(values = c('darkblue', 'darkred',   'darkgreen', 'purple3' )) +
  theme_bw() +
  theme(text = element_text(family="Times"),
        axis.text.x = element_text(size = 16),
        axis.text.y = element_text(size = 16, color = c('darkblue', 'darkred',   'darkgreen', 'purple3' )),
        axis.title = element_text(size = 20),
        axis.ticks = element_blank(),
        panel.grid.minor.y = element_blank(),
        panel.grid.major.y = element_blank(),
        panel.grid.minor.x = element_blank(),
        legend.position = "none",
        panel.background = element_blank(),
        plot.background = element_blank(),
        panel.border = element_rect(color="darkgrey"),
        axis.title.y = element_blank()
  )


```

***Figure 1:*** Posterior densities for how well each factor predicts religious disbelief (standardized beta).



### Planned Interactions

Next, we probed for interactions between the four factors. Results suggest an interaction between cultural learning and reflective cognitive style . We broke down this interaction in two different ways. First, we considered the association between disbelief and reflective cognitive style among those comparatively high and low on credible cultural cues of religious belief (Figure 2a). Reflective cognitive style primarily predicts religious disbelief among those who were also comparatively low in cultural exposure to credible religious cues of faith. Second, we predicted current religious belief from cultural exposure to credibility enhancing displays of religion and then correlated reflective cognitive style with the residual. Effectively, this analysis suggests that reflective thinkers tend to be less religious than one would assume based solely on their cultural exposure to religious cues (Figure 2b). It is thus possible that reflective cognitive style is one mechanism that leads people to lose faith over time ##; in contrast, an intuitive cognitive style leads people to adhere to their early cultural inputs and perhaps become more religious in some contexts. These patterns highlight the interactive roles of cultural context and evolved intuitions on religious cognition, as predicted by dual inheritance theories.

```{r interaction plot, echo=FALSE, warning=FALSE, message=FALSE}

dcrt_cred_cv <- select(d, disbelief, cred_lo, reflection, ageZ, educZ, femZ, social_consZ, econ_consZ, eXtra_m, Consc_m, Neuro_m, Agree_m, Open_m, Hum_m)
dcrt_cred_cv <- dcrt_cred_cv[complete.cases(dcrt_cred_cv),]

dcrt_cred_cv$belief <- dcrt_cred_cv$disbelief * -1
dcrt_cred_cv$cred <- dcrt_cred_cv$cred_lo * -1

leastcred <- min(dcrt_cred_cv$cred)
mostcred <- max(dcrt_cred_cv$cred)


meanCRED_a <- intx$a
meanCRED_b <- intx$b_ref
minCRED_a <- intx$b_cred*leastcred + intx$a
minCRED_b <- intx$b_ref + intx$b_int * leastcred
maxCRED_a <- intx$b_cred * mostcred + intx$a
maxCRED_b <- intx$b_ref + intx$b_int * mostcred

cred_crt <- data.frame(meanCRED_a, meanCRED_b, minCRED_a, minCRED_b, maxCRED_a, maxCRED_b)




# get means for lines

mean.int <- mean(cred_crt$meanCRED_a)
mean.slope <- mean(cred_crt$meanCRED_b)
min.int <- mean(cred_crt$minCRED_a)
min.slope <- mean(cred_crt$minCRED_b)
max.int <- mean(cred_crt$maxCRED_a)
max.slope <- mean(cred_crt$maxCRED_b)

# get 20 smaples of each

cred_crt <- cred_crt[sample(1:nrow(cred_crt)), ] #shuffle the deck

mean.20int <- c(cred_crt$meanCRED_a[1:100])
mean.20slope <- c(cred_crt$meanCRED_b[1:100])

min.20int <- c(cred_crt$minCRED_a[1:100])
min.20slope <- c(cred_crt$minCRED_b[1:100])

max.20int <- c(cred_crt$maxCRED_a[1:100])
max.20slope <- c(cred_crt$maxCRED_b[1:100])

# to plot this shizzle

d <- data.frame(x=c(min(dcrt_cred_cv$reflection), 0, max(dcrt_cred_cv$reflection)))

brange <- max(dcrt_cred_cv$reflection) - min(dcrt_cred_cv$reflection)

decs <- seq(from=0, to=1, by=.33)

b.breaks <- min(dcrt_cred_cv$reflection) + decs*brange


meancol <- 'black'
mincol <- 'purple'
maxcol <- 'hotpink'


ggplot(dcrt_cred_cv, aes(x=reflection, y=belief)) +
  geom_point(alpha=.05, position = 'jitter') +
  scale_x_continuous(breaks=b.breaks, labels=c(0, 3, 6, 9)) +
  labs(x="Cognitive Reflection\n(correct CRT items)", y="Belief") +
  geom_abline(slope=mean.20slope, intercept=mean.20int, lwd=.2, col=meancol, alpha=.15) +
  geom_abline(slope=min.20slope, intercept=min.20int, lwd=.2, col=mincol, alpha=.15) +
  geom_abline(slope=max.20slope, intercept=max.20int, lwd=.2, col=maxcol, alpha=.15) +
  geom_abline(slope=c(mean.slope, min.slope, max.slope), intercept=c(mean.int, min.int, max.int), col=c(meancol, mincol, maxcol), lwd=1.2) +
  annotate("text", x = 0.3, y = c(.7, 0.1, -1.2), label = c("Max CRED", "Mean CRED", "Min CRED"), hjust=0, vjust=0, size=6, color=c(maxcol, meancol, mincol), family = "Times") +
  theme_bw() +
  theme(text = element_text(family="Times"),
        axis.text = element_text(size = 16),
        axis.title = element_text(size = 20),
        panel.background = element_blank(),
        plot.background = element_blank(),
        axis.text.y = element_blank(),
        axis.ticks.y = element_blank(),
        panel.grid.major.x = element_blank() ,
        panel.grid.minor.x = element_blank() ,
        panel.grid.major.y = element_blank() ,
        panel.grid.minor.y = element_blank() ,
        panel.border = element_rect(color="darkgrey"),
        plot.margin = unit(c(1, 1, 1, 1), "lines")) 


```

***Figure 2:*** Interaction between CREDs and Cognitive Reflection

```{r individual tables, echo=FALSE}
zeros <- read.csv('zero-order-posteriors.csv')
zeros <- select(zeros, -X)

zero.m <- zeros %>% sapply(mean) %>% unname %>% round(digits = 2)
zero.l <- zeros %>% sapply(low) %>% unname %>% round(digits = 2)
zero.h <- zeros %>% sapply(high) %>% unname %>% round(digits = 2)
zero.pr <- zeros %>% sapply(biggerZero) %>% unname %>% round(digits = 2) 

pdi <- paste0('[', zero.l, ', ', zero.h, ']')


v <- c('Low Mentalizing', 'Mentalizing (quad)', 'High Security', 'Low CREDs', 'High Reflection')

zero.table <- data.frame(Variable = v, r = zero.m, HPDI= pdi, Pr = zero.pr)
zero.table$Pr[zero.table$Pr == 1] <- '>0.99'

zerotab <- zero.table %>%
  kable() %>%
  kable_styling(bootstrap_options = "striped", full_width = F, position = "float_right") %>%
  column_spec(1, bold = T)

zerotab

```


### Individual Replications

Finally, we tested each candidate factor in isolation, merely to replicate previous work. In individual zero-order replication analyses (Table 3), only cultural learning and reflective cognitive style emerged as consistent predictors of religious disbelief. That two of the candidate factors culled from existing literature did not appear as robust predictors in these models may suggest tempered enthusiasm for their utility as predictors of individual differences in religiosity more broadly, although they both (especially existential security) may still be useful in analyzing larger-scale regional and international trends.

```{r individual scatters, echo=F, message=F, error=F}
# mentalizing

ggplot(dment_nc, aes(x=-1*ment_lo, y=-1*disbelief)) +
  labs(x='Advanced\nMentalizing', y= 'Belief') +
  geom_point(alpha=.2, position='jitter', color='darkred') +
  stat_smooth(method=lm, color='darkred') +
  theme_bw() +
  theme(text = element_text(family="Times"),
        axis.text = element_blank(),
        axis.ticks = element_blank(),
        axis.title.x = element_text(size = 20, color='darkred'),
        axis.title.y = element_text(size = 20),
        panel.grid.minor.y = element_blank(),
        panel.grid.minor.x = element_blank(),
        panel.grid.major.y = element_blank(),
        panel.grid.major.x = element_blank(),
        panel.background = element_blank(),
        plot.background = element_blank(),
        panel.border = element_rect(color="darkgrey")
  )

# motivation

ggplot(dsec_nc, aes(x=security, y=-1*disbelief)) +
  labs(x='Existential\nSecurity', y= 'Belief') +
  geom_point(alpha=.2, position='jitter', color='darkblue') +
  stat_smooth(method=lm, color='darkblue') +
  theme_bw() +
  theme(text = element_text(family="Times"),
        axis.text = element_blank(),
        axis.ticks = element_blank(),
        axis.title.x = element_text(size = 20, color='darkblue'),
        axis.title.y = element_text(size = 20),
        panel.grid.minor.y = element_blank(),
        panel.grid.minor.x = element_blank(),
        panel.grid.major.y = element_blank(),
        panel.grid.major.x = element_blank(),
        panel.background = element_blank(),
        plot.background = element_blank(),
        panel.border = element_rect(color="darkgrey")
  )

# CREDs

ggplot(dcred_nc, aes(x=-1*cred_lo, y=-1*disbelief)) +
  labs(x='Religious\nCREDs', y= 'Belief') +
  geom_point(alpha=.2, position='jitter', color='purple3') +
  stat_smooth(method=lm, color='purple3') +
  theme_bw() +
  theme(text = element_text(family="Times"),
        axis.text = element_blank(),
        axis.ticks = element_blank(),
        axis.title.x = element_text(size = 20, color='purple3'),
        axis.title.y = element_text(size = 20),
        panel.grid.minor.y = element_blank(),
        panel.grid.minor.x = element_blank(),
        panel.grid.major.y = element_blank(),
        panel.grid.major.x = element_blank(),
        panel.background = element_blank(),
        plot.background = element_blank(),
        panel.border = element_rect(color="darkgrey")
  )


# reflection cognitive style

ggplot(dref_nc, aes(x=reflection, y=-1*disbelief)) +
  labs(x='Cognitive\nReflection', y= 'Belief') +
  geom_point(alpha=.2, position='jitter', color='darkgreen') +
  stat_smooth(method=lm, color='darkgreen') +
  theme_bw() +
  theme(text = element_text(family="Times"),
        axis.text = element_blank(),
        axis.ticks = element_blank(),
        axis.title.x = element_text(size = 20, color='darkgreen'),
        axis.title.y = element_text(size = 20),
        panel.grid.minor.y = element_blank(),
        panel.grid.minor.x = element_blank(),
        panel.grid.major.y = element_blank(),
        panel.grid.major.x = element_blank(),
        panel.background = element_blank(),
        plot.background = element_blank(),
        panel.border = element_rect(color="darkgrey")
  )



